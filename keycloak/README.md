Прототип использования Keycloak для авторизации и регистрации
=================================================== 

Описание модулей
-----------

* ``frontend-registration``:  фронтенд, предоставляющий форму регистрации новых пользователей, использующий
Keycloak REST API для авторизации публичного пользователя клиента для получения прав на ресурсы Бэкенда (`backend`)
* ``frontend-accounting``: фронтед, предоставляющий форму авторизации, использующий Keycloak REST API,
и информацию по авторизованному пользователю полученую по правам авторизованного пользователя из Бэкенда (`backend`)
* ``social-provider-vk``: провайдер авторизации через социальную сеть Вконтакте для Keycloak
* ``user-storage-jpa``: провайдер локальной БД пользователей для Keycloak
* ``authenticator``: провайдер аутентификации через кодовое слово по смс для Keycloak

Сборка и настройка проекта
-----------

* Скачайте `Keycloak` версии `3.4.3-Final` и запустите его в режиме `standalone` на порту `8080`
* Зарегистрируйте два клиента для Фронтенд приложений в одном реалме (Realm) Keycloak и разрешите им доступ к адрессу Бэкенд приложения.
* Создайте роль `user` для доступа к Бэкенду.
* Создайте супер пользователя Фронтенда `frontend-registration` (см. описание внутри) с ролью `user`.
* Перейдите к `social-provider-vk` README.md, для конфигурации провайдера социальной сети Вконтакте.
* Перейдите к `user-storage-jpa` README.md, для конфигурации локально БД пользователей для Keycloak.
* Перейдите к `authenticator` README.md, для конфигурации провайдера кодового слова по смс для Keycloak.
* Соберите и запустите Бэкенд ``backend``, ``frontend-registration`` и ``frontend-accounting`` (см. описание внутри).

Настройка дополнительного функционала Keycloak
------------

### Авторизация через социальные сети

Для подключения авторизации через поддерживаемые социальные сети
см. Social Identity Providers - http://www.keycloak.org/docs/2.5/server_admin/topics/identity-broker/social-login.html.

### Двухфазовая авторизация

На текущий момент Keycloak поддерживает двухфазовую авторизацию только для `FreeOTP` и `Google Authenticator`.
    
По умолчанию политика Keycloak предоставляет пользователям возможность самим установить для себя двухфазовую авторизацию.
Для этого перейдите на стандартный для Keycloak клиент `account` по пути `/auth/realms/realm_name/account`.
Выберите вкладку `Authenticator` и следуйте далее представленной инструкции.
